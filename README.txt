By Yang Du, Bing Xue

This version is perfect, if ever break the other branch, revert to this branch
